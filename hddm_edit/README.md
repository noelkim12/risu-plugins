# Handdam Edit Plugin
RISU AI를 위한 채팅 메시지 편집 플러그인

## 주요 기능

### ✏️ 인라인 편집
- 채팅 메시지에 마우스 호버 시 편집 버튼(✏️) 표시
- 클릭하여 해당 메시지를 textarea로 변환하여 편집 가능
- 저장/취소 버튼으로 편집 완료 또는 취소

### 🎯 지원 요소
다음 요소들에 편집 기능을 제공합니다:
- `span.text p` - 일반 텍스트 단락
- `span.text li` - 리스트 항목
- `div.x-risu-regex-quote-block` - 인용 블록
- `div.x-risu-regex-thought-block` - 생각 블록
- `div.x-risu-regex-sound-block` - 사운드 블록
- `div.x-risu-message` - 메시지 블록
- `div.x-risu-lb-nai-character-tags` - 캐릭터 태그
- `div.x-risu-lb-nai-comp-tags` - 컴포넌트 태그

### 🎨 사용자 경험
- **호버 효과**: 마우스 오버 시에만 편집 버튼 표시
- **반응형**: 요소 크기에 맞춰 textarea 크기 자동 조정
- **SPA 지원**: 페이지 전환 시 자동으로 옵저버 재설정
- **성능 최적화**: IntersectionObserver와 MutationObserver 활용

## 설치 방법

1. RISU AI에서 플러그인 관리자 열기
2. "새 플러그인 추가" 클릭
3. `hddm_edit_plugin.js` 파일을 업로드
4. 플러그인 활성화

## 사용법

1. 채팅 메시지에 마우스를 올리면 편집 버튼(✏️)이 나타납니다
2. 편집 버튼을 클릭하면 해당 메시지가 편집 모드로 전환됩니다
3. 텍스트를 수정한 후 "저장" 버튼을 클릭하여 변경사항을 저장합니다
4. "취소" 버튼을 클릭하면 변경사항을 취소하고 원래 상태로 돌아갑니다

## TODO
- RisuAI 플러그인 탭 내부 Argument 관리 기능을 통한 편집 대상 selector 관리

## !!알려진 이슈!!

1. 중복단어 전체 치환 이슈
한줄 단위로 메세지를 수정하는데, 텍스트가 짧아서 중복이 발생하는 경우 죄다 바꿔버림 
이전/이후 문자열까지 splice한 뒤 치환하면 될 것 같은데 잔버그가 많이나서 일단 보류
5글자 미만일 경우 치환 못하게 하는 방법도 고려중 좋은 아이디어 있으면 제보해주세요
** !짧은 텍스트를 치환하는 경우 주의할 것! **

2. 정규식 미적용
텍스트 일부가 정규식이 적용되어있는 경우, 문자열 수정 시 정규식이 깨짐
새로고침하면 돌아오긴 하지만 크게 방해가 되지 않을 것 같으므로 일단 보류..

## CHANGELOG
* v0.1 
- 최초 배포
* v0.2 
- 드래그 등으로 텍스트 선택 및 복사 시 이모지가 포함되는 오류 수정
* v0.3 
- 수정 취소 혹은 변경사항이 없을 시 html tag원복
* v0.4 
- 예측할 수 없는 개행 이슈로 인해 css 속성 변경
- 이제 수정버튼은 더이상 메세지 내부에서 영역을 차지하지 않습니다.
- 루비가 안죽었을 때 루비태그가 포함된 메세지 수정 시 루비가 사망해버리는 오류 수정
* v0.5
- 특정케이스에서 스크롤되지 않는 오류 수정(overflow css관련)
* v0.6
- Plugin DND 플러그인과 호환을 위한 namespace변경
* v0.7
- 정규식 치환된 문자열에 일부 대응
* v0.8 
- 뷰어 익스텐션 호환이슈 수정